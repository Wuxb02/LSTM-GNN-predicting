# æ•°æ®æ ¼å¼è¯´æ˜Žæ–‡æ¡£

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜Žäº†GNNæ°”æ¸©é¢„æµ‹é¡¹ç›®ä¸­ä½¿ç”¨çš„æ•°æ®æ ¼å¼,åŒ…æ‹¬åŽŸå§‹CSVæ•°æ®å’Œè½¬æ¢åŽçš„NPYæ•°ç»„æ ¼å¼ã€‚

---

## ç›®å½•

- [1. æ•°æ®æ–‡ä»¶æ¦‚è§ˆ](#1-æ•°æ®æ–‡ä»¶æ¦‚è§ˆ)
- [2. NPYæ•°ç»„æ ¼å¼](#2-npyæ•°ç»„æ ¼å¼)
- [3. CSVåŽŸå§‹æ•°æ®æ ¼å¼](#3-csvåŽŸå§‹æ•°æ®æ ¼å¼)
- [4. 4ç»´æ—¶é—´å‘¨æœŸç¼–ç ](#4-4ç»´æ—¶é—´å‘¨æœŸç¼–ç )
- [5. ä½¿ç”¨ç¤ºä¾‹](#5-ä½¿ç”¨ç¤ºä¾‹)
- [6. æ•°æ®å¤„ç†æµç¨‹](#6-æ•°æ®å¤„ç†æµç¨‹)
- [7. å¸¸è§é—®é¢˜](#7-å¸¸è§é—®é¢˜)

---

## 1. æ•°æ®æ–‡ä»¶æ¦‚è§ˆ

### 1.1 ç›®å½•ç»“æž„

```
gnn_predict/
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ result/                                    # åŽŸå§‹CSVæ•°æ®
â”‚   â”‚   â”œâ”€â”€ merged_data_2010_2000m.csv            # 2010å¹´æ•°æ® (365å¤© Ã— 28ç«™ = 10,220è¡Œ)
â”‚   â”‚   â”œâ”€â”€ merged_data_2011_2000m.csv            # 2011å¹´æ•°æ® (365å¤© Ã— 28ç«™ = 10,220è¡Œ)
â”‚   â”‚   â”œâ”€â”€ merged_data_2012_2000m.csv            # 2012å¹´æ•°æ® (366å¤© Ã— 28ç«™ = 10,248è¡Œ, é—°å¹´)
â”‚   â”‚   â”œâ”€â”€ merged_data_2013_2000m.csv            # 2013å¹´æ•°æ® (365å¤© Ã— 28ç«™ = 10,220è¡Œ)
â”‚   â”‚   â”œâ”€â”€ merged_data_2014_2000m.csv            # 2014å¹´æ•°æ® (365å¤© Ã— 28ç«™ = 10,220è¡Œ)
â”‚   â”‚   â”œâ”€â”€ merged_data_2015_2000m.csv            # 2015å¹´æ•°æ® (365å¤© Ã— 28ç«™ = 10,220è¡Œ)
â”‚   â”‚   â”œâ”€â”€ merged_data_2016_2000m.csv            # 2016å¹´æ•°æ® (366å¤© Ã— 28ç«™ = 10,248è¡Œ, é—°å¹´)
â”‚   â”‚   â””â”€â”€ merged_data_2017_2000m.csv            # 2017å¹´æ•°æ® (365å¤© Ã— 28ç«™ = 10,220è¡Œ)
â”‚   â”‚
â”‚   â”œâ”€â”€ real_weather_data_2010_2017.npy           # è½¬æ¢åŽçš„çœŸå®žæ•°æ® [2922, 28, 28] â­
â”‚   â”œâ”€â”€ station_info.npy                          # æ°”è±¡ç«™ä¿¡æ¯ [28, 4] â­
â”‚   â”œâ”€â”€ convert_real_data.py                      # æ•°æ®è½¬æ¢è„šæœ¬
â”‚   â””â”€â”€ README.md                                 # æ•°æ®ç›®å½•è¯´æ˜Ž
â”‚
â”œâ”€â”€ myGNN/                                        # æ ¸å¿ƒæ¡†æž¶
â”‚   â”œâ”€â”€ dataset.py                                # æ•°æ®åŠ è½½(4ç»´æ—¶é—´ç¼–ç )
â”‚   â””â”€â”€ ...
â”‚
â””â”€â”€ DATA_FORMAT.md                                # æœ¬æ–‡æ¡£
```

### 1.2 æ•°æ®è¦†ç›–èŒƒå›´

| é¡¹ç›® | è¯´æ˜Ž |
|------|------|
| **æ—¶é—´èŒƒå›´** | 2010å¹´1æœˆ1æ—¥ - 2017å¹´12æœˆ31æ—¥ï¼ˆ8å¹´å®Œæ•´æ•°æ®ï¼‰ |
| **æ°”è±¡ç«™æ•°é‡** | 28ä¸ª |
| **åœ°ç†ä½ç½®** | ä¸­å›½åŽå—åœ°åŒºï¼ˆç»åº¦: 111.0Â°-114.0Â°E, çº¬åº¦: 21.4Â°-23.4Â°Nï¼‰ |
| **æ—¶é—´åˆ†è¾¨çŽ‡** | æ—¥æ•°æ®ï¼ˆæ¯å¤©ä¸€ä¸ªè§‚æµ‹å€¼ï¼‰ |
| **æ€»æ•°æ®é‡** | 81,816æ¡è®°å½•ï¼ˆçº¦2922å¤© Ã— 28ç«™ï¼Œè€ƒè™‘é—°å¹´ï¼‰ |
| **æ•°æ®æ¥æº** | çœŸå®žæ°”è±¡è§‚æµ‹ + ERA5å†åˆ†æžæ•°æ® + æ¤è¢«æ•°æ® |

### 1.3 æ•°æ®é›†åˆ’åˆ†

| æ•°æ®é›† | æ—¶é—´èŒƒå›´ | ç´¢å¼•èŒƒå›´ | å¤©æ•° | è¯´æ˜Ž |
|-------|---------|---------|------|------|
| **è®­ç»ƒé›†** | 2010-2015å¹´ | 0-2190 | 2191å¤© | 6å¹´å®Œæ•´æ•°æ® |
| **éªŒè¯é›†** | 2016å¹´ | 2191-2556 | 366å¤© | é—°å¹´,ç”¨äºŽè¶…å‚æ•°è°ƒä¼˜ |
| **æµ‹è¯•é›†** | 2017å¹´ | 2557-2921 | 365å¤© | ç‹¬ç«‹æµ‹è¯•,è¯„ä¼°æ³›åŒ–æ€§èƒ½ |

**åˆ’åˆ†åŽŸåˆ™:**
- æŒ‰å¹´ä»½åˆ’åˆ†,é¿å…æ—¶é—´æ³„éœ²
- è®­ç»ƒé›†å æ¯”çº¦75%(6å¹´/8å¹´)
- éªŒè¯é›†å’Œæµ‹è¯•é›†å„å çº¦12.5%
- ä¿æŒæ—¶é—´è¿žç»­æ€§,ç¬¦åˆå®žé™…é¢„æµ‹åœºæ™¯

---

## 2. NPYæ•°ç»„æ ¼å¼

### 2.1 ä¸»æ•°æ®æ•°ç»„ (`real_weather_data_2010_2017.npy`) â­â­â­

#### 2.1.1 æ•°ç»„ç»´åº¦

```python
shape: [æ—¶é—´æ­¥, æ°”è±¡ç«™æ•°, ç‰¹å¾æ•°] = [2922, 28, 28]
```

- **ç»´åº¦0 (æ—¶é—´æ­¥)**: 2922å¤© (2010-01-01 è‡³ 2017-12-31, åŒ…å«2ä¸ªé—°å¹´)
- **ç»´åº¦1 (æ°”è±¡ç«™)**: 28ä¸ªæ°”è±¡ç«™ï¼ŒæŒ‰ç«™ç‚¹IDå‡åºæŽ’åº
- **ç»´åº¦2 (ç‰¹å¾)**: 28ä¸ªç‰¹å¾ï¼ˆå®Œæ•´ç‰¹å¾é›†ï¼‰

#### 2.1.2 ç‰¹å¾é¡ºåºä¸Žç´¢å¼•ï¼ˆ28ä¸ªç‰¹å¾ï¼‰

| ç´¢å¼• | ç‰¹å¾å | ç±»åž‹ | å•ä½ | å…¸åž‹èŒƒå›´ | è¯´æ˜Ž |
|:----:|--------|------|:----:|---------|------|
| **ç©ºé—´ç‰¹å¾ï¼ˆé™æ€ï¼‰** |
| 0 | `x` | ç©ºé—´ | Â° | 111.0-114.0 | ç»åº¦ï¼ˆä¸œç»ï¼‰ |
| 1 | `y` | ç©ºé—´ | Â° | 21.4-23.4 | çº¬åº¦ï¼ˆåŒ—çº¬ï¼‰ |
| 2 | `height` | ç©ºé—´ | m | å˜åŒ–èŒƒå›´ | æµ·æ‹”é«˜åº¦ |
| **æ¸©åº¦ç‰¹å¾ï¼ˆåŠ¨æ€ï¼‰** â­ |
| 3 | `tmin` | æ°”è±¡ | Â°C | 2.4-32.1 | æ—¥æœ€ä½Žæ°”æ¸© |
| 4 | `tmax` | æ°”è±¡ | Â°C | 12.1-38.4 | **æ—¥æœ€é«˜æ°”æ¸©ï¼ˆä¸»è¦é¢„æµ‹ç›®æ ‡ï¼‰** |
| 5 | `tave` | æ°”è±¡ | Â°C | 6.7-28.7 | æ—¥å¹³å‡æ°”æ¸© |
| **æ°”è±¡è¦ç´ ï¼ˆåŠ¨æ€ï¼‰** |
| 6 | `pre` | æ°”è±¡ | mm | 0.0-200.0 | æ—¥é™æ°´é‡ |
| 7 | `prs` | æ°”è±¡ | hPa | 997.5-1018.2 | æ°”åŽ‹ï¼ˆç™¾å¸•ï¼‰ |
| 8 | `rh` | æ°”è±¡ | % | 24.0-95.0 | ç›¸å¯¹æ¹¿åº¦ |
| 9 | `win` | æ°”è±¡ | m/s | 1.0-5.8 | é£Žé€Ÿ |
| **åŸŽå¸‚çŽ¯å¢ƒç‰¹å¾ï¼ˆé™æ€ï¼‰** |
| 10 | `BH` | çŽ¯å¢ƒ | m | 12.8-19.6 | å»ºç­‘å¹³å‡é«˜åº¦ï¼ˆ1kmç¼“å†²åŒºå†…ï¼‰ |
| 11 | `BHstd` | çŽ¯å¢ƒ | m | 9.8-18.8 | å»ºç­‘é«˜åº¦æ ‡å‡†å·® |
| 12 | `SCD` | çŽ¯å¢ƒ | - | 0.075-0.562 | åœ°è¡¨è¦†ç›–å¯†åº¦ï¼ˆSurface Cover Densityï¼‰ |
| 13 | `PLA` | çŽ¯å¢ƒ | - | 0.051-0.482 | è·¯é¢é“ºè£…çŽ‡ï¼ˆPaved Land Area ratioï¼‰ |
| 14 | `Î»p` | çŽ¯å¢ƒ | - | - | å¤©ç©ºå¼€é˜”åº¦å‚æ•°Î»p |
| 15 | `Î»b` | çŽ¯å¢ƒ | - | - | å¤©ç©ºå¼€é˜”åº¦å‚æ•°Î»b |
| 16 | `POI` | çŽ¯å¢ƒ | - | 0.108-0.118 | å…´è¶£ç‚¹å¯†åº¦ï¼ˆPoint of Interest densityï¼‰ |
| 17 | `POW` | çŽ¯å¢ƒ | - | 0.0044-0.0046 | å·¥äººå£å¯†åº¦ç›¸å…³ç‰¹å¾ |
| 18 | `POV` | çŽ¯å¢ƒ | - | 0.25-0.888 | è½¦è¾†å¯†åº¦ç›¸å…³ç‰¹å¾ |
| **æ¤è¢«ç‰¹å¾** |
| 19 | `NDVI` | çŽ¯å¢ƒ | - | 0.25-0.49 | å½’ä¸€åŒ–æ¤è¢«æŒ‡æ•°ï¼ˆNormalized Difference Vegetation Indexï¼‰ |
| **ERA5å†åˆ†æžæ•°æ®** |
| 20 | `surface_pressure` | æ°”è±¡ | Pa | 99500-101100 | ERA5åœ°è¡¨æ°”åŽ‹ï¼ˆå¸•æ–¯å¡ï¼Œç»å¯¹å€¼ï¼‰ |
| 21 | `surface_solar_radiation` | æ°”è±¡ | J/mÂ² | 1.5M-20M | ERA5åœ°è¡¨å¤ªé˜³è¾å°„ä¸‹è¡Œé€šé‡ï¼ˆæ—¥ç´¯ç§¯ï¼‰ |
| 22 | `u_wind` | æ°”è±¡ | m/s | - | 10mé«˜åº¦Uåˆ†é‡é£Žé€Ÿï¼ˆä¸œè¥¿æ–¹å‘ï¼‰ |
| 23 | `v_wind` | æ°”è±¡ | m/s | - | 10mé«˜åº¦Våˆ†é‡é£Žé€Ÿï¼ˆå—åŒ—æ–¹å‘ï¼‰ |
| **æ¤è¢«é«˜åº¦ç‰¹å¾** â­æ–°å¢ž |
| 24 | `VegHeight_mean` | çŽ¯å¢ƒ | m | - | æ¤è¢«é«˜åº¦å‡å€¼ |
| 25 | `VegHeight_std` | çŽ¯å¢ƒ | m | - | æ¤è¢«é«˜åº¦æ ‡å‡†å·® |
| **æ—¶é—´ç‰¹å¾ï¼ˆè½¬æ¢ä¸º4ç»´sin/cosç¼–ç ï¼‰** â­â­â­ |
| 26 | `doy` | æ—¶é—´ | - | 1-366 | å¹´å†…æ—¥åºæ•°ï¼ˆDay of Yearï¼‰ |
| 27 | `month` | æ—¶é—´ | - | 1-12 | æœˆä»½ |

#### 2.1.3 ç‰¹å¾åˆ†ç±»æ±‡æ€»

**é™æ€ç‰¹å¾ï¼ˆç«™ç‚¹å›ºå®šï¼Œä¸éšæ—¶é—´å˜åŒ–ï¼‰:**
- ç©ºé—´: `x, y, height` (0-2)
- åŸŽå¸‚çŽ¯å¢ƒ: `BH, BHstd, SCD, PLA, Î»p, Î»b, POI, POW, POV` (10-18)
- æ¤è¢«: `NDVI, VegHeight_mean, VegHeight_std` (19, 24-25)

**åŠ¨æ€ç‰¹å¾ï¼ˆæ¯å¤©å˜åŒ–ï¼‰:**
- æ¸©åº¦: `tmin, tmax, tave` (3-5)
- æ°”è±¡è¦ç´ : `pre, prs, rh, win` (6-9)
- ERA5æ•°æ®: `surface_pressure, surface_solar_radiation, u_wind, v_wind` (20-23)

**æ—¶é—´ç‰¹å¾ï¼ˆå‘¨æœŸæ€§ï¼‰:**
- `doy, month` (26-27) â†’ åœ¨dataset.pyä¸­è‡ªåŠ¨è½¬æ¢ä¸º4ç»´sin/cosç¼–ç 

#### 2.1.4 æ•°æ®ç±»åž‹ä¸Žå­˜å‚¨

```python
dtype: np.float32  # å•ç²¾åº¦æµ®ç‚¹æ•°ï¼ŒèŠ‚çœå­˜å‚¨ç©ºé—´
size: ~9.2 MB      # 2922 Ã— 28 Ã— 28 Ã— 4 bytes = 9,175,296 bytes
```

#### 2.1.5 è®¿é—®ç¤ºä¾‹

```python
import numpy as np

# åŠ è½½æ•°æ®
data = np.load('data/real_weather_data_2010_2017.npy')
print(f"æ•°æ®å½¢çŠ¶: {data.shape}")  # (2922, 28, 28)

# èŽ·å–ç¬¬10å¤©ã€æ‰€æœ‰æ°”è±¡ç«™çš„æœ€é«˜æ°”æ¸©
tmax_day10 = data[9, :, 4]  # shape: (28,) - æ³¨æ„tmaxç´¢å¼•ä¸º4

# èŽ·å–59264å·æ°”è±¡ç«™ï¼ˆç´¢å¼•0ï¼‰2010å¹´å…¨å¹´çš„æ¸©åº¦åºåˆ—
station_0_tmax = data[:365, 0, 4]  # shape: (365,)

# èŽ·å–æ‰€æœ‰ç«™ç‚¹ã€æ‰€æœ‰æ—¶é—´çš„ç»çº¬åº¦ï¼ˆç”¨äºŽæž„å»ºå›¾ï¼‰
lon = data[0, :, 0]  # shape: (28,) - ç»åº¦åœ¨æ—¶é—´ç»´åº¦ä¸Šæ’å®š
lat = data[0, :, 1]  # shape: (28,)

# èŽ·å–æ—¶é—´ç‰¹å¾ï¼ˆdoyå’Œmonthï¼‰
doy_all = data[:, :, 26]   # shape: (2922, 28) - å¹´å†…æ—¥åºæ•°
month_all = data[:, :, 27] # shape: (2922, 28) - æœˆä»½

# æå–è®­ç»ƒé›†æ•°æ®ï¼ˆ2010-2015å¹´ï¼‰
train_data = data[0:2191, :, :]  # shape: (2191, 28, 28)

# æå–éªŒè¯é›†æ•°æ®ï¼ˆ2016å¹´ï¼‰
val_data = data[2191:2557, :, :]  # shape: (366, 28, 28)

# æå–æµ‹è¯•é›†æ•°æ®ï¼ˆ2017å¹´ï¼‰
test_data = data[2557:2922, :, :]  # shape: (365, 28, 28)
```

### 2.2 æ°”è±¡ç«™ä¿¡æ¯æ•°ç»„ (`station_info.npy`)

#### 2.2.1 æ•°ç»„ç»´åº¦

```python
shape: [æ°”è±¡ç«™æ•°, ä¿¡æ¯ç»´åº¦] = [28, 4]
```

- **ç»´åº¦0**: 28ä¸ªæ°”è±¡ç«™ï¼ŒæŒ‰ç«™ç‚¹IDå‡åºæŽ’åˆ—
- **ç»´åº¦1**: 4ä¸ªä¿¡æ¯å­—æ®µï¼ˆID, ç»åº¦, çº¬åº¦, é«˜åº¦ï¼‰

#### 2.2.2 å­—æ®µè¯´æ˜Ž

| ç´¢å¼• | å­—æ®µ | è¯´æ˜Ž |
|:----:|------|------|
| 0 | Station ID | WMOç«™ç‚¹ç¼–ç  (59264-59493) |
| 1 | Longitude | ç»åº¦ (Â°E, 111.0-114.0) |
| 2 | Latitude | çº¬åº¦ (Â°N, 21.4-23.4) |
| 3 | Height | æµ·æ‹”é«˜åº¦ (m) |

#### 2.2.3 è®¿é—®ç¤ºä¾‹

```python
import numpy as np

# åŠ è½½æ°”è±¡ç«™ä¿¡æ¯
station_info = np.load('data/station_info.npy')
print(f"æ°”è±¡ç«™ä¿¡æ¯å½¢çŠ¶: {station_info.shape}")  # (28, 4)

# èŽ·å–æ‰€æœ‰ç«™ç‚¹ID
station_ids = station_info[:, 0].astype(int)
print(f"ç«™ç‚¹æ•°é‡: {len(station_ids)}")  # 28

# èŽ·å–æ‰€æœ‰ç«™ç‚¹çš„ç»çº¬åº¦
coords = station_info[:, 1:3]  # shape: (28, 2)
lon = station_info[:, 1]       # shape: (28,)
lat = station_info[:, 2]       # shape: (28,)

# æŸ¥æ‰¾ç‰¹å®šç«™ç‚¹çš„ä¿¡æ¯
target_id = 59264
idx = np.where(station_info[:, 0] == target_id)[0][0]
station_info_59264 = station_info[idx]
print(f"ç«™ç‚¹{target_id}: ç»åº¦={station_info_59264[1]:.2f}Â°, "
      f"çº¬åº¦={station_info_59264[2]:.2f}Â°, "
      f"é«˜åº¦={station_info_59264[3]:.2f}m")

# è®¡ç®—ç«™ç‚¹é—´è·ç¦»ï¼ˆç”¨äºŽæž„å»ºå›¾ï¼‰
from scipy.spatial.distance import cdist
distances = cdist(coords, coords, metric='euclidean')  # shape: (28, 28)
```

---

## 3. CSVåŽŸå§‹æ•°æ®æ ¼å¼

### 3.1 æ–‡ä»¶åŸºæœ¬ä¿¡æ¯

- **ç¼–ç **: UTF-8 (å¸¦BOM)
- **åˆ†éš”ç¬¦**: é€—å· (,)
- **æ¯è¡Œå«ä¹‰**: ä¸€ä¸ªæ°”è±¡ç«™åœ¨æŸä¸€å¤©çš„è§‚æµ‹æ•°æ®
- **æ•°æ®ç»„ç»‡**: æŒ‰æ—¥æœŸå’Œæ°”è±¡ç«™IDæŽ’åˆ—

### 3.2 CSVå­—æ®µå®šä¹‰ï¼ˆ29ä¸ªåˆ—ï¼‰

CSVæ–‡ä»¶åŒ…å«29ä¸ªåˆ—ï¼ˆåŒ…æ‹¬id, doy, monthç­‰å…ƒæ•°æ®ï¼‰ï¼ŒNPYæ•°ç»„ä¿ç•™28ä¸ªç‰¹å¾åˆ—ï¼ˆæŽ’é™¤idï¼‰ã€‚

| CSVåˆ— | NPYç´¢å¼• | å­—æ®µå | æ•°æ®ç±»åž‹ | å•ä½ | è¯´æ˜Ž |
|:----:|:------:|--------|---------|------|------|
| 1 | - | `id` | int | - | æ°”è±¡ç«™WMOç¼–ç ï¼ˆè½¬æ¢æ—¶æŽ’é™¤ï¼‰ |
| 2 | 0 | `x` | float | Â° | ç»åº¦ |
| 3 | 1 | `y` | float | Â° | çº¬åº¦ |
| 4 | 2 | `height` | float | m | æµ·æ‹”é«˜åº¦ |
| 5 | 3 | `tmin` | float | Â°C | æ—¥æœ€ä½Žæ°”æ¸© |
| 6 | 4 | `tmax` | float | Â°C | æ—¥æœ€é«˜æ°”æ¸© |
| 7 | 5 | `tave` | float | Â°C | æ—¥å¹³å‡æ°”æ¸© |
| 8 | 6 | `pre` | float | mm | æ—¥é™æ°´é‡ |
| 9 | 7 | `prs` | float | hPa | æ°”åŽ‹ |
| 10 | 8 | `rh` | float | % | ç›¸å¯¹æ¹¿åº¦ |
| 11 | 9 | `win` | float | m/s | é£Žé€Ÿ |
| 12 | 10 | `BH` | float | m | å»ºç­‘å¹³å‡é«˜åº¦ |
| 13 | 11 | `BHstd` | float | m | å»ºç­‘é«˜åº¦æ ‡å‡†å·® |
| 14 | 12 | `SCD` | float | - | åœ°è¡¨è¦†ç›–å¯†åº¦ |
| 15 | 13 | `PLA` | float | - | è·¯é¢é“ºè£…çŽ‡ |
| 16 | 14 | `Î»p` | float | - | å¤©ç©ºå¼€é˜”åº¦å‚æ•°Î»p |
| 17 | 15 | `Î»b` | float | - | å¤©ç©ºå¼€é˜”åº¦å‚æ•°Î»b |
| 18 | 16 | `POI` | float | - | å…´è¶£ç‚¹å¯†åº¦ |
| 19 | 17 | `POW` | float | - | å·¥äººå£å¯†åº¦ |
| 20 | 18 | `POV` | float | - | è½¦è¾†å¯†åº¦ |
| 21 | 19 | `NDVI` | float | - | å½’ä¸€åŒ–æ¤è¢«æŒ‡æ•° |
| 22 | 20 | `surface_pressure` | float | Pa | ERA5åœ°è¡¨æ°”åŽ‹ |
| 23 | 21 | `surface_solar_radiation` | float | J/mÂ² | ERA5å¤ªé˜³è¾å°„ |
| 24 | 22 | `u_component_of_wind_10m` | float | m/s | Uåˆ†é‡é£Žé€Ÿ |
| 25 | 23 | `v_component_of_wind_10m` | float | m/s | Våˆ†é‡é£Žé€Ÿ |
| 26 | 24 | `VegHeight_mean` | float | m | æ¤è¢«é«˜åº¦å‡å€¼ |
| 27 | 25 | `VegHeight_std` | float | m | æ¤è¢«é«˜åº¦æ ‡å‡†å·® |
| 28 | 26 | `doy` | int | - | å¹´å†…æ—¥åºæ•° |
| 29 | 27 | `month` | int | - | æœˆä»½ |

### 3.3 æ•°æ®ç¤ºä¾‹

```csv
id,x,y,height,tmin,tmax,tave,pre,prs,rh,win,BH,BHstd,SCD,PLA,Î»p,Î»b,POI,POW,POV,NDVI,surface_pressure,surface_solar_radiation,u_wind,v_wind,VegHeight_mean,VegHeight_std,doy,month
59264,111.51,23.4,45.3,11.2,18.3,14.5,3.4,1008.5,92.0,1.2,12.81,9.87,0.075,0.051,0.15,0.12,0.108,0.0044,0.888,0.459,99701.5,5246494.0,2.3,1.1,8.5,2.1,1,1
59264,111.51,23.4,45.3,12.1,19.9,15.8,7.8,1007.3,94.0,2.3,12.81,9.87,0.075,0.051,0.15,0.12,0.108,0.0044,0.888,0.457,99749.5,1576552.0,3.1,0.9,8.5,2.1,2,1
59269,111.82,23.21,28.6,10.8,19.2,14.9,2.1,1009.1,88.0,1.5,15.34,12.45,0.124,0.089,0.18,0.14,0.112,0.0045,0.756,0.412,99823.2,5389721.0,1.8,1.3,9.2,2.3,1,1
...
```

---

## 4. 4ç»´æ—¶é—´å‘¨æœŸç¼–ç 

### 4.1 ä¸ºä»€ä¹ˆéœ€è¦æ—¶é—´å‘¨æœŸç¼–ç ?

åŽŸå§‹æ—¶é—´ç‰¹å¾`doy`(1-366)å’Œ`month`(1-12)æ˜¯ç¦»æ•£æ•°å€¼,å­˜åœ¨ä»¥ä¸‹é—®é¢˜:
1. **ä¸è¿žç»­æ€§**: 1æœˆ(1)å’Œ12æœˆ(12)æ•°å€¼å·®å¼‚å¤§,ä½†å®žé™…ä¸Šç›¸é‚»
2. **çº¿æ€§å‡è®¾**: ç¥žç»ç½‘ç»œä¼šå‡è®¾doy=2æ¯”doy=1é«˜ä¸€å€çš„å…³ç³»,è¿™æ˜¯é”™è¯¯çš„
3. **å‘¨æœŸæ€§ä¸¢å¤±**: æ— æ³•ä½“çŽ°å¹´åº¦å‘¨æœŸå’Œå­£èŠ‚å‘¨æœŸ

### 4.2 ç¼–ç åŽŸç†

ä½¿ç”¨**sin/coså˜æ¢**å°†ç¦»æ•£æ—¶é—´ç‰¹å¾è½¬æ¢ä¸ºè¿žç»­å‘¨æœŸæ€§ç¼–ç :

```python
# å¹´å‘¨æœŸç¼–ç ï¼ˆdoy: 1-366 â†’ doy_sin, doy_cosï¼‰
year_phase = 2Ï€ Ã— (doy - 1) / days_in_year  # é—°å¹´366,å¹³å¹´365
doy_sin = sin(year_phase)
doy_cos = cos(year_phase)

# æœˆå‘¨æœŸç¼–ç ï¼ˆmonth: 1-12 â†’ month_sin, month_cosï¼‰
month_phase = 2Ï€ Ã— (month - 1) / 12
month_sin = sin(month_phase)
month_cos = cos(month_phase)
```

**ä¼˜åŠ¿:**
- âœ… **å‘¨æœŸè¿žç»­æ€§**: 12æœˆ31æ—¥å’Œ1æœˆ1æ—¥çš„ç¼–ç å€¼ç›¸è¿‘
- âœ… **å”¯ä¸€æ€§**: sin/cosç»„åˆå¯å”¯ä¸€ç¡®å®šæ—¶é—´ç‚¹
- âœ… **å¹³æ»‘æ€§**: ç›¸é‚»æ—¶é—´ç‚¹çš„ç¼–ç å€¼å¹³æ»‘å˜åŒ–
- âœ… **æ¨¡åž‹å‹å¥½**: æ›´é€‚åˆç¥žç»ç½‘ç»œå­¦ä¹ å‘¨æœŸæ€§è§„å¾‹

### 4.3 ç¼–ç æµç¨‹

åœ¨`myGNN/dataset.py`ä¸­è‡ªåŠ¨å®Œæˆ:

```python
# æ­¥éª¤1: æå–åŽŸå§‹æ—¶é—´ç‰¹å¾
doy = MetData[:, :, 26]    # shape: (2922, 28)
month = MetData[:, :, 27]  # shape: (2922, 28)

# æ­¥éª¤2: è®¡ç®—å‘¨æœŸç›¸ä½
T, N, _ = MetData.shape
days_in_year = np.array([365 if year % 4 != 0 else 366
                         for year in range(2010, 2018)])  # å¤„ç†é—°å¹´
year_phase = 2 * np.pi * (doy - 1) / days_in_year[:, None]
month_phase = 2 * np.pi * (month - 1) / 12

# æ­¥éª¤3: sin/coså˜æ¢
doy_sin = np.sin(year_phase).astype(np.float32)
doy_cos = np.cos(year_phase).astype(np.float32)
month_sin = np.sin(month_phase).astype(np.float32)
month_cos = np.cos(month_phase).astype(np.float32)

# æ­¥éª¤4: ç§»é™¤åŽŸå§‹æ—¶é—´ç‰¹å¾ï¼ˆç´¢å¼•26-27ï¼‰
base_features = MetData[:, :, :26]  # shape: (2922, 28, 26)

# æ­¥éª¤5: æ‹¼æŽ¥4ç»´æ—¶é—´ç¼–ç 
temporal_encoding = np.stack([doy_sin, doy_cos, month_sin, month_cos],
                             axis=-1)  # shape: (2922, 28, 4)
final_data = np.concatenate([base_features, temporal_encoding],
                            axis=-1)  # shape: (2922, 28, 30)

# æœ€ç»ˆè¾“å…¥ç»´åº¦: 26 (åŸºç¡€ç‰¹å¾) + 4 (æ—¶é—´ç¼–ç ) = 30
```

### 4.4 ç‰¹å¾ç»´åº¦å˜åŒ–

```
åŽŸå§‹æ•°æ®: [2922, 28, 28]
     â”‚
     â”œâ”€ ç§»é™¤doyå’Œmonth (ç´¢å¼•26-27)
     â”‚   â†’ [2922, 28, 26] åŸºç¡€ç‰¹å¾
     â”‚
     â”œâ”€ ç”Ÿæˆ4ç»´æ—¶é—´ç¼–ç 
     â”‚   - doy_sin, doy_cos (å¹´å‘¨æœŸ)
     â”‚   - month_sin, month_cos (æœˆå‘¨æœŸ)
     â”‚   â†’ [2922, 28, 4] æ—¶é—´ç¼–ç 
     â”‚
     â””â”€ æ‹¼æŽ¥
         â†’ [2922, 28, 30] æœ€ç»ˆè¾“å…¥
```

### 4.5 ä»£ç ç¤ºä¾‹

```python
from myGNN.dataset import WeatherGraphDataset, create_dataloaders

# åŠ è½½æ•°æ®
MetData = np.load('data/real_weather_data_2010_2017.npy')  # [2922, 28, 28]

# åˆ›å»ºæ•°æ®é›†ï¼ˆè‡ªåŠ¨è¿›è¡Œ4ç»´æ—¶é—´ç¼–ç ï¼‰
train_loader, val_loader, test_loader = create_dataloaders(
    config, graph, MetData,
    batch_size=32, shuffle_train=True
)

# æŸ¥çœ‹æ•°æ®ç»´åº¦
for batch in train_loader:
    print(f"èŠ‚ç‚¹ç‰¹å¾å½¢çŠ¶: {batch.x.shape}")
    # è¾“å‡º: torch.Size([28, 7, 30]) - [nodes, hist_len, features]
    # 30 = 26 (åŸºç¡€ç‰¹å¾) + 4 (æ—¶é—´ç¼–ç )
    break
```

---

## 5. ä½¿ç”¨ç¤ºä¾‹

### 5.1 åŸºç¡€æ•°æ®åŠ è½½

```python
import numpy as np

# åŠ è½½æ•°æ®
data = np.load('data/real_weather_data_2010_2017.npy')
station_info = np.load('data/station_info.npy')

print(f"æ•°æ®å½¢çŠ¶: {data.shape}")           # (2922, 28, 28)
print(f"æ°”è±¡ç«™ä¿¡æ¯: {station_info.shape}") # (28, 4)
print(f"ç‰¹å¾æ•°é‡: {data.shape[2]}")        # 28
```

### 5.2 æ•°æ®æŽ¢ç´¢

```python
# 1. èŽ·å–ç‰¹å®šç‰¹å¾çš„æ—¶é—´åºåˆ—
tmax_all = data[:, :, 4]  # æ‰€æœ‰ç«™ç‚¹çš„æœ€é«˜æ°”æ¸©ï¼Œshape: (2922, 28)

# 2. è®¡ç®—å…¨å±€ç»Ÿè®¡é‡
print(f"æœ€é«˜æ°”æ¸©èŒƒå›´: {tmax_all.min():.2f}Â°C - {tmax_all.max():.2f}Â°C")
print(f"æœ€é«˜æ°”æ¸©å‡å€¼: {tmax_all.mean():.2f}Â°C")
print(f"æœ€é«˜æ°”æ¸©æ ‡å‡†å·®: {tmax_all.std():.2f}Â°C")

# 3. æå–å•ä¸ªæ°”è±¡ç«™çš„æ•°æ®
station_0_data = data[:, 0, :]  # ç¬¬ä¸€ä¸ªæ°”è±¡ç«™ï¼Œshape: (2922, 28)

# 4. æå–æŸä¸€å¤©çš„æ‰€æœ‰ç«™ç‚¹æ•°æ®
day_100_data = data[99, :, :]  # ç¬¬100å¤©ï¼Œshape: (28, 28)

# 5. åˆ†æžå­£èŠ‚æ€§è§„å¾‹
import matplotlib.pyplot as plt

# ç»˜åˆ¶2017å¹´ï¼ˆæµ‹è¯•é›†ï¼‰çš„æ¸©åº¦æ›²çº¿
test_tmax = data[2557:2922, :, 4]  # æµ‹è¯•é›†æœ€é«˜æ°”æ¸©
plt.figure(figsize=(12, 4))
plt.plot(test_tmax.mean(axis=1))
plt.title('2017å¹´å¹³å‡æœ€é«˜æ°”æ¸©')
plt.xlabel('å¤©æ•°')
plt.ylabel('æ¸©åº¦ (Â°C)')
plt.grid(True)
plt.show()
```

### 5.3 åœ¨myGNNæ¡†æž¶ä¸­ä½¿ç”¨

```python
from myGNN.config import create_config, print_config
from myGNN.dataset import create_dataloaders
from myGNN.graph.distance_graph import create_graph_from_config
import numpy as np

# 1. åˆ›å»ºé…ç½®
config, arch_config, loss_config = create_config()

# 2. åŠ è½½æ•°æ®
MetData = np.load(config.MetData_fp)  # [2922, 28, 28]
station_info = np.load(config.station_info_fp)  # [28, 4]

# 3. æž„å»ºå›¾ç»“æž„
graph = create_graph_from_config(config, station_info)

# 4. åˆ›å»ºæ•°æ®åŠ è½½å™¨ï¼ˆè‡ªåŠ¨è¿›è¡Œ4ç»´æ—¶é—´ç¼–ç ï¼‰
train_loader, val_loader, test_loader = create_dataloaders(
    config, graph, MetData,
    batch_size=config.batch_size,
    shuffle_train=True
)

# 5. æŸ¥çœ‹æ•°æ®ç»´åº¦
for batch in train_loader:
    print(f"æ‰¹æ¬¡å¤§å°: {batch.num_graphs}")
    print(f"èŠ‚ç‚¹ç‰¹å¾: {batch.x.shape}")  # [nodes, hist_len, 30]
    print(f"è¾¹ç´¢å¼•: {batch.edge_index.shape}")  # [2, num_edges]
    print(f"æ ‡ç­¾: {batch.y.shape}")  # [nodes, pred_len]
    break

# æœ€ç»ˆè¾“å…¥ç»´åº¦è¯´æ˜Ž:
# batch.x.shape[-1] = 30
# = 26 (åŸºç¡€ç‰¹å¾: x,y,height,tmin,tmax,tave,pre,prs,rh,win,
#               BH,BHstd,SCD,PLA,Î»p,Î»b,POI,POW,POV,NDVI,
#               surface_pressure,surface_solar_radiation,u_wind,v_wind,
#               VegHeight_mean,VegHeight_std)
# + 4 (æ—¶é—´ç¼–ç : doy_sin,doy_cos,month_sin,month_cos)
```

### 5.4 æ•°æ®æ ‡å‡†åŒ–

```python
# è®¡ç®—è®­ç»ƒé›†çš„å‡å€¼å’Œæ ‡å‡†å·®
train_data = data[config.train_start:config.train_end]  # 2010-2015å¹´

# å¯¹æ¯ä¸ªç‰¹å¾åˆ†åˆ«æ ‡å‡†åŒ–
feature_means = train_data.mean(axis=(0, 1))  # shape: (28,)
feature_stds = train_data.std(axis=(0, 1))    # shape: (28,)

# æ ‡å‡†åŒ–æ‰€æœ‰æ•°æ®
data_normalized = (data - feature_means) / (feature_stds + 1e-8)

# ä»…æ ‡å‡†åŒ–ç›®æ ‡å˜é‡ï¼ˆtmaxï¼‰
tmax_mean = train_data[:, :, 4].mean()
tmax_std = train_data[:, :, 4].std()
print(f"tmaxå‡å€¼: {tmax_mean:.2f}Â°C, æ ‡å‡†å·®: {tmax_std:.2f}Â°C")

# ä¿å­˜æ ‡å‡†åŒ–å‚æ•°ï¼ˆç”¨äºŽåæ ‡å‡†åŒ–ï¼‰
np.savez('data/normalization_params.npz',
         feature_means=feature_means,
         feature_stds=feature_stds,
         tmax_mean=tmax_mean,
         tmax_std=tmax_std)

# åæ ‡å‡†åŒ–
def denormalize(normalized, mean, std):
    return normalized * std + mean

# ä½¿ç”¨ç¤ºä¾‹
predictions_normalized = model(test_data)  # æ¨¡åž‹è¾“å‡º
predictions = denormalize(predictions_normalized, tmax_mean, tmax_std)
```

### 5.5 ç‰¹å¾é€‰æ‹©

```python
from myGNN.config import Config

config = Config()

# æ–¹æ³•1: ä½¿ç”¨æ‰€æœ‰åŸºç¡€ç‰¹å¾ï¼ˆé»˜è®¤ï¼‰
config.feature_indices = None
# è‡ªåŠ¨ä½¿ç”¨ç´¢å¼•0-25ï¼ˆç§»é™¤doyå’Œmonthï¼‰
# åŠ ä¸Š4ç»´æ—¶é—´ç¼–ç ï¼Œæœ€ç»ˆç»´åº¦=30

# æ–¹æ³•2: ä»…ä½¿ç”¨æ ¸å¿ƒæ°”è±¡ç‰¹å¾
config.feature_indices = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
# 0-2: x, y, height (ç©ºé—´ç‰¹å¾)
# 3-5: tmin, tmax, tave (æ¸©åº¦)
# 6-9: pre, prs, rh, win (æ°”è±¡è¦ç´ )
# åŠ ä¸Š4ç»´æ—¶é—´ç¼–ç ï¼Œæœ€ç»ˆç»´åº¦=14

# æ–¹æ³•3: ä½¿ç”¨æ‰€æœ‰ç‰¹å¾ï¼ˆåŒ…æ‹¬åŸŽå¸‚çŽ¯å¢ƒï¼‰
config.feature_indices = list(range(26))  # 0-25
# åŠ ä¸Š4ç»´æ—¶é—´ç¼–ç ï¼Œæœ€ç»ˆç»´åº¦=30

# æ–¹æ³•4: è‡ªå®šä¹‰ç‰¹å¾ç»„åˆ
config.feature_indices = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 19, 24, 25]
# æ ¸å¿ƒæ°”è±¡ + NDVI + æ¤è¢«é«˜åº¦
# åŠ ä¸Š4ç»´æ—¶é—´ç¼–ç ï¼Œæœ€ç»ˆç»´åº¦=17
```

### 5.6 æž„å»ºç©ºé—´å›¾

```python
from myGNN.graph.distance_graph import create_graph_from_config

# æ–¹æ³•1: ä½¿ç”¨é…ç½®è‡ªåŠ¨æž„å»ºï¼ˆæŽ¨èï¼‰
graph = create_graph_from_config(config, station_info)

# æ–¹æ³•2: æ‰‹åŠ¨æž„å»ºKè¿‘é‚»é€†è·ç¦»å›¾
from myGNN.graph.distance_graph import Graph_inv_dis

lon = station_info[:, 1]
lat = station_info[:, 2]

graph = Graph_inv_dis(
    lon=lon,
    lat=lat,
    top_neighbors=10,      # Kè¿‘é‚»æ•°é‡
    use_edge_attr=True     # ä½¿ç”¨é€†è·ç¦»ä½œä¸ºè¾¹æƒé‡
)

# å›¾å¯¹è±¡å±žæ€§
print(f"è¾¹ç´¢å¼•: {graph.edge_index.shape}")  # [2, num_edges]
print(f"è¾¹æƒé‡: {graph.edge_attr.shape}")   # [num_edges, 1]
print(f"èŠ‚ç‚¹æ•°: {graph.num_nodes}")         # 28
print(f"è¾¹æ•°: {graph.num_edges}")           # çº¦280 (28Ã—10)
```

---

## 6. æ•°æ®å¤„ç†æµç¨‹

### 6.1 å®Œæ•´æ•°æ®æµ

```
CSVåŽŸå§‹æ•°æ® (8ä¸ªæ–‡ä»¶, 2010-2017å¹´)
     â”‚
     â”œâ”€ [data/convert_real_data.py]
     â”‚   â”œâ”€ è¯»å–å¹¶åˆå¹¶æ‰€æœ‰CSV
     â”‚   â”œâ”€ æå–æ°”è±¡ç«™ä¿¡æ¯
     â”‚   â”œâ”€ è½¬æ¢ä¸ºNPYæ•°ç»„ [2922, 28, 28]
     â”‚   â””â”€ ä¿å­˜NPYæ–‡ä»¶
     â”‚
     â†“
NPYæ•°ç»„æ–‡ä»¶
â”œâ”€â”€ real_weather_data_2010_2017.npy [2922, 28, 28]
â””â”€â”€ station_info.npy [28, 4]
     â”‚
     â”œâ”€ [myGNN/dataset.py]
     â”‚   â”œâ”€ ç§»é™¤doyå’Œmonth (ç´¢å¼•26-27)
     â”‚   â”‚   â†’ [2922, 28, 26] åŸºç¡€ç‰¹å¾
     â”‚   â”‚
     â”‚   â”œâ”€ ç”Ÿæˆ4ç»´æ—¶é—´ç¼–ç 
     â”‚   â”‚   - doy â†’ doy_sin, doy_cos (å¹´å‘¨æœŸ)
     â”‚   â”‚   - month â†’ month_sin, month_cos (æœˆå‘¨æœŸ)
     â”‚   â”‚   â†’ [2922, 28, 4] æ—¶é—´ç¼–ç 
     â”‚   â”‚
     â”‚   â”œâ”€ æ‹¼æŽ¥ç‰¹å¾
     â”‚   â”‚   â†’ [2922, 28, 30] å®Œæ•´ç‰¹å¾
     â”‚   â”‚
     â”‚   â”œâ”€ æ»‘åŠ¨çª—å£åˆ‡åˆ†
     â”‚   â”‚   hist_len=7, pred_len=3
     â”‚   â”‚   â†’ è¾“å…¥: [hist_len, 30]
     â”‚   â”‚   â†’ è¾“å‡º: [pred_len]
     â”‚   â”‚
     â”‚   â”œâ”€ æ•°æ®é›†åˆ’åˆ†
     â”‚   â”‚   - è®­ç»ƒé›†: 0-2190 (2010-2015)
     â”‚   â”‚   - éªŒè¯é›†: 2191-2556 (2016)
     â”‚   â”‚   - æµ‹è¯•é›†: 2557-2921 (2017)
     â”‚   â”‚
     â”‚   â””â”€ æ ‡å‡†åŒ–ï¼ˆåŸºäºŽè®­ç»ƒé›†ç»Ÿè®¡é‡ï¼‰
     â”‚
     â†“
DataLoaderæ‰¹æ¬¡
â”œâ”€â”€ batch.x: [nodes, hist_len, 30] èŠ‚ç‚¹ç‰¹å¾
â”œâ”€â”€ batch.y: [nodes, pred_len] ç›®æ ‡æ ‡ç­¾
â”œâ”€â”€ batch.edge_index: [2, num_edges] è¾¹ç´¢å¼•
â””â”€â”€ batch.edge_attr: [num_edges, 1] è¾¹æƒé‡
     â”‚
     â”œâ”€ [myGNN/models/]
     â”‚   - GAT_LSTM / GSAGE_LSTM / GAT_SeparateEncoder
     â”‚
     â†“
æ¨¡åž‹é¢„æµ‹è¾“å‡º [batchÃ—nodes, pred_len]
```

### 6.2 æ•°æ®è½¬æ¢è„šæœ¬ä½¿ç”¨

```bash
# è¿è¡Œæ•°æ®è½¬æ¢è„šæœ¬
cd data
python convert_real_data.py
```

**è„šæœ¬è¾“å‡ºç¤ºä¾‹:**
```
================================================================================
çœŸå®žæ°”è±¡æ•°æ®è½¬æ¢è„šæœ¬
================================================================================

æ•°æ®ç›®å½•: C:\Users\wxb55\Desktop\gnn_predict\data\result
è¾“å‡ºç›®å½•: C:\Users\wxb55\Desktop\gnn_predict\data

--------------------------------------------------------------------------------
æ­¥éª¤ 1/4: åŠ è½½CSVæ–‡ä»¶
--------------------------------------------------------------------------------
æ‰¾åˆ° 8 ä¸ªCSVæ–‡ä»¶:
  - merged_data_2010_2000m.csv
  - merged_data_2011_2000m.csv
  - merged_data_2012_2000m.csv
  - merged_data_2013_2000m.csv
  - merged_data_2014_2000m.csv
  - merged_data_2015_2000m.csv
  - merged_data_2016_2000m.csv
  - merged_data_2017_2000m.csv

åˆå¹¶åŽæ•°æ®: 81816è¡Œ
æ—¶é—´èŒƒå›´: 2010-01-01 è‡³ 2017-12-31
æ°”è±¡ç«™æ•°é‡: 28

--------------------------------------------------------------------------------
æ­¥éª¤ 2/4: æå–æ°”è±¡ç«™ä¿¡æ¯
--------------------------------------------------------------------------------
æ°”è±¡ç«™ä¿¡æ¯:
  æ•°é‡: 28
  IDèŒƒå›´: 59264 - 59493
  ç»åº¦èŒƒå›´: 111.00Â° - 114.00Â°
  çº¬åº¦èŒƒå›´: 21.40Â° - 23.40Â°

--------------------------------------------------------------------------------
æ­¥éª¤ 3/4: è½¬æ¢ä¸ºNPYæ•°ç»„æ ¼å¼
--------------------------------------------------------------------------------
æ•°ç»„ç»´åº¦:
  æ—¶é—´æ­¥æ•°: 2922
  æ°”è±¡ç«™æ•°: 28
  ç‰¹å¾æ•°: 28

æ•°æ®ç»Ÿè®¡:
  å½¢çŠ¶: (2922, 28, 28)
  æ•°æ®ç±»åž‹: float32
  æœ€å°å€¼: 0.00
  æœ€å¤§å€¼: 20000000.00

--------------------------------------------------------------------------------
æ­¥éª¤ 4/4: ä¿å­˜æ–‡ä»¶
--------------------------------------------------------------------------------
âœ“ ä¿å­˜æ•°æ®æ•°ç»„: data/real_weather_data_2010_2017.npy
  å½¢çŠ¶: (2922, 28, 28)
  å¤§å°: 9.17 MB

âœ“ ä¿å­˜æ°”è±¡ç«™ä¿¡æ¯: data/station_info.npy
  å½¢çŠ¶: (28, 4)
  å¤§å°: 0.44 KB

================================================================================
è½¬æ¢å®Œæˆ!
================================================================================
```

### 6.3 æ•°æ®éªŒè¯

```python
import numpy as np

# 1. åŠ è½½æ•°æ®
data = np.load('data/real_weather_data_2010_2017.npy')
station_info = np.load('data/station_info.npy')

# 2. æ£€æŸ¥å½¢çŠ¶
assert data.shape == (2922, 28, 28), f"æ•°æ®å½¢çŠ¶é”™è¯¯: {data.shape}"
assert station_info.shape == (28, 4), f"æ°”è±¡ç«™ä¿¡æ¯å½¢çŠ¶é”™è¯¯: {station_info.shape}"

# 3. æ£€æŸ¥ç¼ºå¤±å€¼
assert not np.isnan(data).any(), "å­˜åœ¨ç¼ºå¤±å€¼"
assert not np.isnan(station_info).any(), "æ°”è±¡ç«™ä¿¡æ¯å­˜åœ¨ç¼ºå¤±å€¼"

# 4. æ£€æŸ¥æ•°å€¼èŒƒå›´
tmax = data[:, :, 4]
assert tmax.min() > -20 and tmax.max() < 50, f"æ¸©åº¦èŒƒå›´å¼‚å¸¸: {tmax.min():.2f} - {tmax.max():.2f}"

# 5. æ£€æŸ¥æ—¶é—´è¿žç»­æ€§
doy = data[:, 0, 26]  # ç¬¬ä¸€ä¸ªç«™ç‚¹çš„doyåºåˆ—
print(f"DOYèŒƒå›´: {doy.min():.0f} - {doy.max():.0f}")
assert doy.min() >= 1 and doy.max() <= 366, "DOYèŒƒå›´å¼‚å¸¸"

# 6. æ£€æŸ¥ç«™ç‚¹ID
station_ids = station_info[:, 0].astype(int)
assert len(np.unique(station_ids)) == 28, "ç«™ç‚¹IDä¸å”¯ä¸€"
assert station_ids.min() >= 59000 and station_ids.max() < 60000, "ç«™ç‚¹IDèŒƒå›´å¼‚å¸¸"

print("âœ“ æ‰€æœ‰éªŒè¯é€šè¿‡!")
```

---

## 7. å¸¸è§é—®é¢˜

### Q1: ä¸ºä»€ä¹ˆNPYæ–‡ä»¶æ¯”CSVå°?

**A:** NPYä½¿ç”¨äºŒè¿›åˆ¶å­˜å‚¨,è€ŒCSVæ˜¯æ–‡æœ¬æ ¼å¼ã€‚äºŒè¿›åˆ¶å­˜å‚¨æ›´ç´§å‡‘,ä¸”NPYä½¿ç”¨float32(4å­—èŠ‚)è€Œéžæ–‡æœ¬å­—ç¬¦ä¸²ã€‚

**å¯¹æ¯”:**
- CSV: ~20-30 MB (8ä¸ªæ–‡ä»¶åˆè®¡, æ–‡æœ¬æ ¼å¼)
- NPY: ~9.2 MB (å•ä¸ªæ–‡ä»¶, äºŒè¿›åˆ¶æ ¼å¼)

### Q2: å¦‚ä½•å¤„ç†é—°å¹´æ•°æ®?

**A:** è½¬æ¢è„šæœ¬å’Œdataset.pyè‡ªåŠ¨å¤„ç†é—°å¹´:
- 2012å¹´å’Œ2016å¹´æœ‰366å¤©
- å…¶ä»–å¹´ä»½365å¤©
- æ€»è®¡2922å¤© = 365Ã—6 + 366Ã—2

åœ¨4ç»´æ—¶é—´ç¼–ç æ—¶,ä½¿ç”¨åŠ¨æ€days_in_year:
```python
days_in_year = 366 if year % 4 == 0 else 365
year_phase = 2 * np.pi * (doy - 1) / days_in_year
```

### Q3: ç‰¹å¾ç´¢å¼•ä¸ºä»€ä¹ˆä¸ŽCSVåˆ—ä¸å®Œå…¨å¯¹åº”?

**A:** NPYæ ¼å¼ç§»é™¤äº†å…ƒæ•°æ®åˆ—:
- CSVåŒ…å«29åˆ—ï¼ˆå«id, doy, monthç­‰ï¼‰
- NPYä¿ç•™28åˆ—ï¼ˆæŽ’é™¤idï¼‰
- dataset.pyè¿›ä¸€æ­¥å¤„ç†æ—¶ç§»é™¤doyå’Œmonth(ç´¢å¼•26-27),è½¬æ¢ä¸º4ç»´sin/cosç¼–ç 
- æœ€ç»ˆè¾“å…¥ç»´åº¦: 26(åŸºç¡€ç‰¹å¾) + 4(æ—¶é—´ç¼–ç ) = 30

### Q4: å¦‚ä½•é€‰æ‹©é¢„æµ‹ç›®æ ‡?

**A:** æ¡†æž¶æ”¯æŒå¤šç§é¢„æµ‹ç›®æ ‡:
- **tmax**(ç´¢å¼•4): æ—¥æœ€é«˜æ°”æ¸©ï¼ˆé»˜è®¤æŽ¨èï¼‰
- tmin(ç´¢å¼•3): æ—¥æœ€ä½Žæ°”æ¸©
- tave(ç´¢å¼•5): æ—¥å¹³å‡æ°”æ¸©

é…ç½®æ–¹æ³•:
```python
config.target_feature_idx = 4  # tmax
```

### Q5: æ•°æ®éœ€è¦æ ‡å‡†åŒ–å—?

**A:** å¼ºçƒˆæŽ¨èæ ‡å‡†åŒ–,åŽŸå› :
- ç‰¹å¾é‡çº²å·®å¼‚å¤§ï¼ˆæ¸©åº¦Â°C vs å¤ªé˜³è¾å°„J/mÂ²ï¼‰
- åŠ é€Ÿæ¨¡åž‹æ”¶æ•›
- æé«˜æ•°å€¼ç¨³å®šæ€§

**æ ‡å‡†åŒ–æ–¹æ³•:**
```python
# åŸºäºŽè®­ç»ƒé›†ç»Ÿè®¡é‡
normalized = (value - train_mean) / train_std

# é¢„æµ‹åŽåæ ‡å‡†åŒ–
actual = normalized * train_std + train_mean
```

### Q6: ä¸ºä»€ä¹ˆä½¿ç”¨4ç»´æ—¶é—´ç¼–ç è€Œä¸æ˜¯ç›´æŽ¥ä½¿ç”¨doyå’Œmonth?

**A:** 4ç»´sin/cosç¼–ç çš„ä¼˜åŠ¿:
- âœ… æ•èŽ·å‘¨æœŸæ€§è§„å¾‹ï¼ˆå¹´å‘¨æœŸã€æœˆå‘¨æœŸï¼‰
- âœ… é¿å…ç¦»æ•£ç‰¹å¾çš„è·³è·ƒï¼ˆ12æœˆâ†’1æœˆè¿žç»­ï¼‰
- âœ… ä¿æŒç›¸é‚»æ—¶é—´ç‚¹çš„è¿žç»­æ€§
- âœ… æ›´é€‚åˆç¥žç»ç½‘ç»œå­¦ä¹ 

**å¯¹æ¯”:**
```python
# åŽŸå§‹ç¼–ç é—®é¢˜
doy = [1, 2, ..., 365, 366, 1, 2, ...]  # 365â†’1è·³è·ƒ
month = [12, 1, 2, ...]  # 12â†’1è·³è·ƒ

# sin/cosç¼–ç 
doy_sin, doy_cos  # è¿žç»­å‘¨æœŸå‡½æ•°,365å’Œ1çš„ç¼–ç ç›¸è¿‘
month_sin, month_cos  # 12æœˆå’Œ1æœˆçš„ç¼–ç ç›¸è¿‘
```

### Q7: å¦‚ä½•ä½¿ç”¨è‡ªå·±çš„æ•°æ®?

**A:** å‡†å¤‡æ•°æ®:
1. **æ ¼å¼è¦æ±‚**: NPYæ•°ç»„ `[time_steps, num_stations, features]`
2. **æ°”è±¡ç«™ä¿¡æ¯**: NPYæ•°ç»„ `[num_stations, 4]` (ID, ç»åº¦, çº¬åº¦, é«˜åº¦)
3. **æœ€å°‘ç‰¹å¾**: è‡³å°‘åŒ…å«é¢„æµ‹ç›®æ ‡å’ŒåŸºæœ¬ç©ºé—´ç‰¹å¾(x, y)

**é…ç½®ä¿®æ”¹:**
```python
# myGNN/config.py
config.MetData_fp = 'data/my_weather_data.npy'
config.station_info_fp = 'data/my_station_info.npy'
config.node_num = ä½ çš„ç«™ç‚¹æ•°é‡
config.base_feature_dim = ä½ çš„ç‰¹å¾æ•°é‡ - 2  # æŽ’é™¤doyå’Œmonth
config.target_feature_idx = ä½ çš„é¢„æµ‹ç›®æ ‡ç´¢å¼•
```

### Q8: å¦‚ä½•æŸ¥çœ‹NPYæ–‡ä»¶å†…å®¹?

**A:** ä½¿ç”¨PythonæŸ¥çœ‹:
```python
import numpy as np

# åŠ è½½æ•°æ®
data = np.load('data/real_weather_data_2010_2017.npy')

# æŸ¥çœ‹å½¢çŠ¶å’Œç»Ÿè®¡ä¿¡æ¯
print(f"å½¢çŠ¶: {data.shape}")
print(f"æ•°æ®ç±»åž‹: {data.dtype}")
print(f"æœ€å°å€¼: {data.min()}")
print(f"æœ€å¤§å€¼: {data.max()}")
print(f"å‡å€¼: {data.mean()}")

# æŸ¥çœ‹ç¬¬ä¸€ä¸ªæ—¶é—´æ­¥ã€ç¬¬ä¸€ä¸ªç«™ç‚¹çš„æ•°æ®
print(data[0, 0, :])

# æŸ¥çœ‹ç‰¹å®šç‰¹å¾
tmax_all = data[:, :, 4]
print(f"tmaxå½¢çŠ¶: {tmax_all.shape}")
print(f"tmaxèŒƒå›´: {tmax_all.min():.2f}Â°C - {tmax_all.max():.2f}Â°C")
```

### Q9: è®­ç»ƒ/éªŒè¯/æµ‹è¯•é›†å¦‚ä½•åˆ’åˆ†?

**A:** æŒ‰å¹´ä»½åˆ’åˆ†,é¿å…æ—¶é—´æ³„éœ²:

| æ•°æ®é›† | å¹´ä»½ | ç´¢å¼•èŒƒå›´ | å¤©æ•° | å æ¯” |
|-------|------|---------|------|------|
| è®­ç»ƒé›† | 2010-2015 | 0-2190 | 2191 | 75% |
| éªŒè¯é›† | 2016 | 2191-2556 | 366 | 12.5% |
| æµ‹è¯•é›† | 2017 | 2557-2921 | 365 | 12.5% |

**é…ç½®:**
```python
config.train_start = 0
config.train_end = 2191
config.val_start = 2191
config.val_end = 2557
config.test_start = 2557
config.test_end = 2922
```

### Q10: å¦‚ä½•å¯¹æ¯”ä¸åŒç‰¹å¾ç»„åˆçš„æ•ˆæžœ?

**A:** ä¿®æ”¹`config.feature_indices`è¿›è¡Œæ¶ˆèžå®žéªŒ:

```python
# å®žéªŒ1: ä»…æ ¸å¿ƒæ°”è±¡ç‰¹å¾
config.feature_indices = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]  # 10ç‰¹å¾
# è®­ç»ƒå¹¶è®°å½•ç»“æžœ: RMSE_1, MAE_1

# å®žéªŒ2: æ ¸å¿ƒæ°”è±¡ + åŸŽå¸‚çŽ¯å¢ƒ
config.feature_indices = list(range(19))  # 19ç‰¹å¾
# è®­ç»ƒå¹¶è®°å½•ç»“æžœ: RMSE_2, MAE_2

# å®žéªŒ3: æ‰€æœ‰ç‰¹å¾
config.feature_indices = None  # 26ç‰¹å¾
# è®­ç»ƒå¹¶è®°å½•ç»“æžœ: RMSE_3, MAE_3

# å¯¹æ¯”åˆ†æž
# å¦‚æžœRMSE_2 < RMSE_1,è¯´æ˜ŽåŸŽå¸‚çŽ¯å¢ƒç‰¹å¾æœ‰æ•ˆ
# å¦‚æžœRMSE_3 â‰ˆ RMSE_2,è¯´æ˜ŽERA5å’Œæ¤è¢«ç‰¹å¾è´¡çŒ®è¾ƒå°
```

---

## é™„å½•

### A. ç‰¹å¾å®Œæ•´åˆ—è¡¨ï¼ˆ28ä¸ªï¼‰

| ç´¢å¼• | ç‰¹å¾å | ç±»åž‹ | å•ä½ | æ˜¯å¦é™æ€ | è¯´æ˜Ž |
|:----:|--------|------|:----:|:--------:|------|
| 0 | x | ç©ºé—´ | Â° | âœ“ | ç»åº¦ |
| 1 | y | ç©ºé—´ | Â° | âœ“ | çº¬åº¦ |
| 2 | height | ç©ºé—´ | m | âœ“ | æµ·æ‹”é«˜åº¦ |
| 3 | tmin | æ°”è±¡ | Â°C | âœ— | æ—¥æœ€ä½Žæ°”æ¸© |
| 4 | tmax | æ°”è±¡ | Â°C | âœ— | **æ—¥æœ€é«˜æ°”æ¸©ï¼ˆä¸»è¦é¢„æµ‹ç›®æ ‡ï¼‰** |
| 5 | tave | æ°”è±¡ | Â°C | âœ— | æ—¥å¹³å‡æ°”æ¸© |
| 6 | pre | æ°”è±¡ | mm | âœ— | æ—¥é™æ°´é‡ |
| 7 | prs | æ°”è±¡ | hPa | âœ— | æ°”åŽ‹ |
| 8 | rh | æ°”è±¡ | % | âœ— | ç›¸å¯¹æ¹¿åº¦ |
| 9 | win | æ°”è±¡ | m/s | âœ— | é£Žé€Ÿ |
| 10 | BH | çŽ¯å¢ƒ | m | âœ“ | å»ºç­‘å¹³å‡é«˜åº¦ |
| 11 | BHstd | çŽ¯å¢ƒ | m | âœ“ | å»ºç­‘é«˜åº¦æ ‡å‡†å·® |
| 12 | SCD | çŽ¯å¢ƒ | - | âœ“ | åœ°è¡¨è¦†ç›–å¯†åº¦ |
| 13 | PLA | çŽ¯å¢ƒ | - | âœ“ | è·¯é¢é“ºè£…çŽ‡ |
| 14 | Î»p | çŽ¯å¢ƒ | - | âœ“ | å¤©ç©ºå¼€é˜”åº¦å‚æ•°Î»p |
| 15 | Î»b | çŽ¯å¢ƒ | - | âœ“ | å¤©ç©ºå¼€é˜”åº¦å‚æ•°Î»b |
| 16 | POI | çŽ¯å¢ƒ | - | âœ“ | å…´è¶£ç‚¹å¯†åº¦ |
| 17 | POW | çŽ¯å¢ƒ | - | âœ“ | å·¥äººå£å¯†åº¦ |
| 18 | POV | çŽ¯å¢ƒ | - | âœ“ | è½¦è¾†å¯†åº¦ |
| 19 | NDVI | çŽ¯å¢ƒ | - | âœ“ | å½’ä¸€åŒ–æ¤è¢«æŒ‡æ•° |
| 20 | surface_pressure | æ°”è±¡ | Pa | âœ— | ERA5åœ°è¡¨æ°”åŽ‹ |
| 21 | surface_solar_radiation | æ°”è±¡ | J/mÂ² | âœ— | ERA5å¤ªé˜³è¾å°„ |
| 22 | u_wind | æ°”è±¡ | m/s | âœ— | 10mé«˜åº¦Uåˆ†é‡é£Žé€Ÿ |
| 23 | v_wind | æ°”è±¡ | m/s | âœ— | 10mé«˜åº¦Våˆ†é‡é£Žé€Ÿ |
| 24 | VegHeight_mean | çŽ¯å¢ƒ | m | âœ“ | æ¤è¢«é«˜åº¦å‡å€¼ |
| 25 | VegHeight_std | çŽ¯å¢ƒ | m | âœ“ | æ¤è¢«é«˜åº¦æ ‡å‡†å·® |
| 26 | doy | æ—¶é—´ | - | âœ— | å¹´å†…æ—¥åºæ•°ï¼ˆè½¬æ¢ä¸ºsin/cosï¼‰ |
| 27 | month | æ—¶é—´ | - | âœ— | æœˆä»½ï¼ˆè½¬æ¢ä¸ºsin/cosï¼‰ |

**è¯´æ˜Ž:**
- âœ“ é™æ€ç‰¹å¾: æ¯ä¸ªç«™ç‚¹å›ºå®š,ä¸éšæ—¶é—´å˜åŒ–
- âœ— åŠ¨æ€ç‰¹å¾: æ¯å¤©å˜åŒ–

### B. ç›¸å…³æ–‡æ¡£

- [README.md](README.md) - é¡¹ç›®æ€»è§ˆ
- [CLAUDE.md](CLAUDE.md) - é¡¹ç›®æž¶æž„è¯¦ç»†è¯´æ˜Ž â­
- [myGNN/README.md](myGNN/README.md) - myGNNæ¡†æž¶æ–‡æ¡£
- [data/README.md](data/README.md) - æ•°æ®ç›®å½•è¯´æ˜Ž
- [myGNN/config.py](myGNN/config.py) - é…ç½®æ–‡ä»¶
- [myGNN/dataset.py](myGNN/dataset.py) - æ•°æ®é›†ç±»ï¼ˆ4ç»´æ—¶é—´ç¼–ç å®žçŽ°ï¼‰
- [data/convert_real_data.py](data/convert_real_data.py) - æ•°æ®è½¬æ¢è„šæœ¬

### C. å‚è€ƒèµ„æ–™

- **ERA5-Landæ–‡æ¡£**: https://confluence.ecmwf.int/display/CKB/ERA5-Land
- **PyTorch Geometricæ•°æ®æ ¼å¼**: https://pytorch-geometric.readthedocs.io/en/latest/notes/introduction.html
- **è®ºæ–‡**: *Intra-city Scale Graph Neural Networks Enhance Short-term Air Temperature Forecasting*
- **æ—¶é—´ç¼–ç **: Vaswani et al. "Attention is All You Need" (Positional Encoding)

### D. æ›´æ–°æ—¥å¿—

#### v3.0 (2025-12-16)
- âœ¨ æ›´æ–°ä¸º28ç‰¹å¾æ ¼å¼ [2922, 28, 28]
- âœ¨ æ–°å¢žæ¤è¢«é«˜åº¦ç‰¹å¾ (VegHeight_mean, VegHeight_std)
- âœ¨ è¯¦ç»†è¯´æ˜Ž4ç»´æ—¶é—´å‘¨æœŸç¼–ç åŽŸç†å’Œå®žçŽ°
- âœ¨ æ–°å¢žæ•°æ®é›†åˆ’åˆ†è¯´æ˜Žï¼ˆè®­ç»ƒ/éªŒè¯/æµ‹è¯•ï¼‰
- âœ¨ å®Œå–„ä½¿ç”¨ç¤ºä¾‹å’ŒFAQ
- ðŸ“ é‡æž„æ–‡æ¡£ç»“æž„,æ›´æ¸…æ™°çš„ç›®å½•ç»„ç»‡

#### v2.0 (2025-11)
- æ›´æ–°ä¸º26ç‰¹å¾æ ¼å¼ [2922, 28, 26]
- æ·»åŠ ERA5å†åˆ†æžæ•°æ®
- å®Œå–„æ•°æ®éªŒè¯æµç¨‹

#### v1.0 (åˆå§‹ç‰ˆæœ¬)
- åŸºç¡€æ•°æ®æ ¼å¼è¯´æ˜Ž
- CSVåˆ°NPYè½¬æ¢æµç¨‹

---

**æ–‡æ¡£ç‰ˆæœ¬**: v3.0
**æœ€åŽæ›´æ–°**: 2025-12-16
**ç»´æŠ¤è€…**: GNNæ°”æ¸©é¢„æµ‹é¡¹ç›®ç»„
